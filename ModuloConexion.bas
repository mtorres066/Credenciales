Attribute VB_Name = "Module1"
Option Explicit

'VARIABLE PARA CONECTARME AL TIPO DE PROVEEDOR
Global GTipoProveedor As String
Global GConectionString As String
Global GConectionString2 As String
Global GConectionString3 As String
Global GConectionString4 As String
'Global GConectionString As String

'Global GConeccion As String
'Global GPassword As String
'Global GOrigenDeDatos As String
'CONEXION PARA ORACLE
Global Conexion As ADODB.Connection
Global Conexion2 As ADODB.Connection
Global Conexion3 As ADODB.Connection
Global Conexion4 As ADODB.Connection
Global GUsuario As String
Global GNumSol As Long

Global StrSql As String


Public Sub Abrir_Recordset(Recordset As ADODB.Recordset, StrSql As String)
'-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset-------------------------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
' Procedimiento : Abrir_Recordset
' Fecha         : 20/11/2006 13:51
' Autor         : Miguel
' Propósito     :ABRIR RECORDSET
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset------------------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo Abrir_Recordset_Error

On Error Resume Next
    Recordset.ActiveConnection = Conexion
    Recordset.LockType = adLockOptimistic
    Recordset.CursorLocation = adUseClient
    Recordset.CursorType = adOpenDynamic
    Recordset.Open StrSql

    If Err <> 0 Then
        'MsgBox Err.Description
    End If

On Error GoTo 0
    Exit Sub
Abrir_Recordset_Error:
    MsgBox "Error " & Err.Number & " (" & Err.Description & ") en procedimiento Abrir_Recordset de Módulo ModuloConexion"
    
End Sub


Public Sub Abrir_Recordset2(Recordset As ADODB.Recordset, StrSql As String)
'-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset-------------------------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
' Procedimiento : Abrir_Recordset
' Fecha         : 20/11/2006 13:51
' Autor         : Miguel
' Propósito     :ABRIR RECORDSET
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset------------------------------------------------------------------------------------------------------------------------------------------------------------

On Error Resume Next
    Recordset.ActiveConnection = Conexion2
    Recordset.LockType = adLockOptimistic
    Recordset.CursorLocation = adUseClient
    Recordset.CursorType = adOpenDynamic
    Recordset.Open StrSql

    If Err <> 0 Then
        'MsgBox Err.Description
    End If

   
End Sub

Public Sub Abrir_Recordset3(Recordset As ADODB.Recordset, StrSql As String)
'-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset-------------------------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
' Procedimiento : Abrir_Recordset
' Fecha         : 20/11/2006 13:51
' Autor         : Miguel
' Propósito     :ABRIR RECORDSET
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset------------------------------------------------------------------------------------------------------------------------------------------------------------

On Error Resume Next
    Recordset.ActiveConnection = Conexion3
    Recordset.LockType = adLockOptimistic
    Recordset.CursorLocation = adUseClient
    Recordset.CursorType = adOpenDynamic
    Recordset.Open StrSql

    If Err <> 0 Then
        'MsgBox Err.Description
    End If

   
End Sub


Public Sub Abrir_Recordset4(Recordset As ADODB.Recordset, StrSql As String)
'-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset-------------------------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
' Procedimiento : Abrir_Recordset Para SQL Server 2005 Express
' Fecha         : 20/11/2006 13:51
' Autor         : Miguel
' Propósito     :ABRIR RECORDSET PARA SQL SERVER PARA ACTUALIZAR LA BD DE CERRADURAS DE HUELLA
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset
'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------Abrir_Recordset------------------------------------------------------------------------------------------------------------------------------------------------------------

On Error Resume Next
    Recordset.ActiveConnection = Conexion4
    Recordset.LockType = adLockOptimistic
    Recordset.CursorLocation = adUseClient
    Recordset.CursorType = adOpenDynamic
    Recordset.Open StrSql

    If Err <> 0 Then
        'MsgBox Err.Description
    End If

   
End Sub

 
Public Sub Desconectar()
    Conexion.Close
    Conexion2.Close
    Conexion3.Close
    Conexion4.Close
    Set Conexion = Nothing
    Set Conexion2 = Nothing
    Set Conexion3 = Nothing
    Set Conexion4 = Nothing
End Sub
